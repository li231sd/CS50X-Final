{% extends "layout.html" %}

{% block title %} Find More {% endblock %}

{% block main %}
<div class="container my-4">
  <div class="card shadow-sm">
    <div class="card-body">

      <h4 class="card-title mb-3">About Activity</h4>

      <!-- Organization Details -->
      <div class="mb-4">
        <h6 class="card-subtitle mb-2 text-muted">Organization Details</h6>
        <ul class="list-unstyled ms-3">
          <li><strong>Organization Name:</strong> {{ info[0][6] }}</li>
          <li><strong>Organization Email:</strong> {{ info[0][7] }}</li>
        </ul>
      </div>

      <!-- Activity Details -->
      <div class="mb-4">
        <h6 class="card-subtitle mb-2 text-muted">Activity Details</h6>
        <ul class="list-unstyled ms-3">
          <li><strong>Activity Name:</strong> {{ info[0][16] }}</li>
          <li><strong>Minimum Activity Age:</strong> {{ info[0][8] }}</li>
          <li><strong>Activity City:</strong> {{ info[0][9] }}</li>
          <li><strong>Activity State:</strong> {{ info[0][10] }}</li>
          <li><strong>Activity Zip:</strong> {{ info[0][11] }}</li>
          <li><strong>Max Participants:</strong> {{ info[0][12] }}</li>
        </ul>
      </div>

      <!-- Date Details -->
      <div class="mb-4">
        <h6 class="card-subtitle mb-2 text-muted">Date Details</h6>
        <ul class="list-unstyled ms-3">
          <li><strong>Start Date:</strong> {{ info[0][13] }}</li>
          <li><strong>End Date:</strong> {{ info[0][14] }}</li>
          <li><strong>Registration Deadline:</strong> {{ info[0][15] }}</li>
        </ul>
      </div>

      <!-- Extra Details -->
      <div class="mb-4">
        <h6 class="card-subtitle mb-2 text-muted">About Activity & Extra Details</h6>
        <ul class="list-unstyled ms-3">
          <li></li><p class="card-text">{{ info[0][17] }}</p></li>
        </ul>
      </div>

      <!-- Registration Note -->
      <div class="alert alert-info mb-4" role="alert">
        <strong>By registering, you are obligated to attend this event or notify the organizer directly about any conflicts.</strong>
      </div>
      

      <!-- Buttons -->
      <div class="d-flex gap-2">
        <a onclick="showConfirm()" class="btn btn-success">Register</a>
        <a href="/" class="btn btn-danger">Back</a>
      </div>

      <!-- Confirmation Box -->
      <div id="register" class="mt-3 d-none border rounded p-3 bg-light">
        <p>Do you want to <strong>register</strong> for this event?</p>
        <div class="d-flex gap-2">
          <a
            href="#"
            onclick="registerUserEvent('{{ info[0][0] }}')"
            class="btn btn-success"
          >
            Yes
          </a>
          <a onclick="closeConfirm()" class="btn btn-danger">No</a>
        </div>
      </div>

    </div>
  </div>
</div>

<script>
  function showConfirm() {
    document.getElementById("register").classList.remove("d-none");
  }

  function closeConfirm() {
    document.getElementById("register").classList.add("d-none");
  }

  function registerUserEvent(id) {
    fetch("/rsvp", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ id: id }),
    }).then((response) => {
      if (response.ok) {
        alert("Successfully Registered");
        window.location.href = "/";
      } else {
        alert("Something went wrong!");
        location.reload();
      }
    });
  }
</script>
{% endblock %}
